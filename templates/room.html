{% extends "base.html" %}
{% block title %}House{% endblock %}
{% block head %}
  {{ super() }}
   <link rel="stylesheet" href="{{url_for('static', filename='css/house.css')}}">
    <link rel="stylesheet" href="https://use.typekit.net/oaq5uou.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.1.2/socket.io.js" integrity="sha512-iZIBSs+gDyTH0ZhUem9eQ1t4DcEn2B9lHxfRMeGQhyNdSUz+rb+5A3ummX6DQTOIs1XK0gOteOg/LPtSo9VJ+w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    
    <style>
        @import url("https://use.typekit.net/oaq5uou.css");
      </style>
      
            
        
        <script>
        console.log('try connect');

        const socket = io.connect('http://192.168.0.201:5000');
        socket.on("connect", function()
        {
            socket.emit('toggle_sensors', {'code':String('{{room.code}}')}); 
        });

        function send_command(relay_id)
        {
            socket.emit('process_request', {'relay':relay_id, 'code':String('{{room.code}}')});
        }

        socket.on('update_sensor',function(data)
        {
            if (data['code'] == '{{room.code}}')
            {
                $('#room-humidity').text(data['humidity']);
                $('#room-temp').text(data['temperature']);
            }

        });

    </script>


 
    
{% endblock %}
{% block content %}
     <ul class="header">
     <li class="back-button">
            <div class="back-icon">
                <input type = "image" class="back-icon-img" src="{{url_for('static', filename='image/back.png')}}" alt="" onclick="goBack()">
            </div>
        </li>
        <li class="edit-button">
             <div class="edit-icon">
                <a href={{url_for('edit_room', sid=room.code)}}>
                     <img class="edit-icon-img" src="{{url_for('static', filename='image/edit.png')}}" alt="">
                </a>
            </div>
        </li>
     
      <li class="title-profile"><p>{{room.name}}</p></li>
    </ul>




    




    <div class="buttons">
        <div class="button-container" id="button-container">
            {%for relay in room.relays%}
            <div class="access-button" id="buttons">
                <button class="button" "btn-selection" id="{{relay.pin}}"  onclick="send_command(this.id);"> {{relay.name}}</button>
            </div>
            {%endfor%}
        </div>
    </div>


    <div class="date-time">
        <div class="half-block">
            <div class="date-time-container">
                <div class="date-time">
                    <p id="room-temp"class="date-time-text">temperature</p>
                </div>
            </div>
        </div>
        <div class="half-block">
            <div class="date-time-container">
                <div class="date-time">
                    <p id= "room-humidity"class="date-time-text" >humidity</p>
                </div>
            </div>
        </div>
    </div>


    <div class="date-time-task" style="border-radius:10px 10px;">
            <div class="half-block">
                <div class="date-time-container">
                    <div class="date-time">
                        <p id="date"class="date-time-text">date</p>
                    </div>
                    <div class="date-time" >
                        <p id= "time" style="font-size:35px;" class="date-time-text" >time</p>
                    </div>
                </div>
            </div>

            <div class="half-block" style="margin-right: 1em;" >
                <div class="access-button" id="buttons">
                        <button type="button" class="button" "btn-selection" id="12" onclick="window.location.href='{{ url_for('controls' , sid=room)}}';"> 
            
                        Add Task +
                        </button>
                </div>
            </div>
            
            <script type="text/javascript" src="{{url_for('static', filename='js/clock.js')}}"></script>
        </div>

        

    
    
{% endblock %}